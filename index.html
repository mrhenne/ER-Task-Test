<!DOCTYPE html>
<html lang="de" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ER Task Radar | Helios</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }

        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        helios: {
                            50: '#ecfdf5',
                            100: '#d1fae5',
                            400: '#34d399',
                            500: '#10b981', 
                            600: '#059669', 
                            700: '#047857',
                        }
                    },
                    animation: {
                        'blob': 'blob 15s infinite',
                        'pulse-glow': 'pulse-glow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'pulse-red-glow': 'pulse-red-glow 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'pulse-border-indigo': 'pulse-border-indigo 2s ease-in-out infinite',
                        'pulse-border-amber': 'pulse-border-amber 2s ease-in-out infinite',
                        'pulse-border-red': 'pulse-border-red 2s ease-in-out infinite'
                    },
                    keyframes: {
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(50px, -50px) scale(1.2)' },
                            '66%': { transform: 'translate(-40px, 40px) scale(0.8)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' },
                        },
                        'pulse-glow': {
                            '0%, 100%': { boxShadow: '0 0 15px rgba(16, 185, 129, 0.1)', borderColor: 'rgba(255, 255, 255, 0.4)' },
                            '50%': { boxShadow: '0 0 25px rgba(16, 185, 129, 0.5)', borderColor: 'rgba(16, 185, 129, 0.7)' },
                        },
                        'pulse-red-glow': {
                            '0%, 100%': { boxShadow: '0 0 15px rgba(239, 68, 68, 0.3)', borderColor: 'rgba(239, 68, 68, 0.4)', backgroundColor: 'rgba(239, 68, 68, 0.05)' },
                            '50%': { boxShadow: '0 0 35px rgba(239, 68, 68, 0.6)', borderColor: 'rgba(239, 68, 68, 0.9)', backgroundColor: 'rgba(239, 68, 68, 0.15)' },
                        },
                        'pulse-border-indigo': {
                            '0%, 100%': { borderColor: 'rgba(99, 102, 241, 0.3)', boxShadow: '0 0 0px rgba(99, 102, 241, 0)' },
                            '50%': { borderColor: 'rgba(99, 102, 241, 0.8)', boxShadow: '0 0 15px rgba(99, 102, 241, 0.5)' },
                        },
                        'pulse-border-amber': {
                            '0%, 100%': { borderColor: 'rgba(245, 158, 11, 0.3)', boxShadow: '0 0 0px rgba(245, 158, 11, 0)' },
                            '50%': { borderColor: 'rgba(245, 158, 11, 0.8)', boxShadow: '0 0 15px rgba(245, 158, 11, 0.5)' },
                        },
                        'pulse-border-red': {
                            '0%, 100%': { borderColor: 'rgba(239, 68, 68, 0.3)', boxShadow: '0 0 0px rgba(239, 68, 68, 0)' },
                            '50%': { borderColor: 'rgba(239, 68, 68, 0.8)', boxShadow: '0 0 15px rgba(239, 68, 68, 0.5)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.5s ease, color 0.5s ease;
        }
        
        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }

        /* Deep Liquid Glass Effects */
        .glass-panel {
            background: rgba(255, 255, 255, 0.35);
            backdrop-filter: blur(28px);
            -webkit-backdrop-filter: blur(28px);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.7);
            transition: all 0.3s ease;
        }
        .dark .glass-panel {
            background: rgba(15, 23, 42, 0.45);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glass-input {
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            transition: all 0.2s ease;
        }
        .dark .glass-input {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        .glass-input:focus {
            background: rgba(255, 255, 255, 0.8);
            border-color: #10b981;
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.2);
        }
        .dark .glass-input:focus {
            background: rgba(30, 41, 59, 0.8);
            border-color: #10b981;
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.3);
        }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(148, 163, 184, 0.4); border-radius: 10px; }
        .dark ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.2); }
        ::-webkit-scrollbar-thumb:hover { background: rgba(148, 163, 184, 0.6); }
        .dark ::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.4); }
        
        .dark .text-glow-green { text-shadow: 0 0 15px rgba(16, 185, 129, 0.7); }
        .dark .text-glow-red { text-shadow: 0 0 15px rgba(239, 68, 68, 0.7); }

        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* Panel Drag & Drop Styling */
        .dashboard-panel {
            transition: transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease;
        }
        .panel-dragging {
            opacity: 0.6;
            transform: scale(0.98);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2) !important;
            z-index: 50;
        }
        .panel-drag-over {
            background: rgba(16, 185, 129, 0.05);
            border-radius: 1rem;
            box-shadow: inset 0 0 0 2px rgba(16, 185, 129, 0.5);
        }

        /* Task Drag & Drop Styles */
        .task-item {
            transition: transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease;
        }
        .task-dragging {
            opacity: 0.4;
            transform: scale(0.98);
        }
        .task-drag-over {
            border-top: 2px solid #10b981;
        }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden relative bg-slate-50 text-slate-800 dark:bg-slate-900 dark:text-fuchsia-50">

    <audio id="gongSound" src="https://assets.mixkit.co/active_storage/sfx/2358/2358-preview.mp3" preload="auto"></audio>

    <!-- Massive Liquid Background Blobs -->
    <div class="fixed inset-0 z-0 overflow-hidden pointer-events-none transition-opacity duration-700 opacity-60 dark:opacity-40">
        <div class="absolute top-[-15%] left-[-10%] w-[40rem] h-[40rem] bg-helios-400 dark:bg-helios-500 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-[120px] dark:blur-[140px] animate-blob"></div>
        <div class="absolute top-[10%] right-[-15%] w-[45rem] h-[45rem] bg-teal-300 dark:bg-teal-600 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-[130px] dark:blur-[150px] animate-blob" style="animation-delay: 3s"></div>
        <div class="absolute bottom-[-25%] left-[15%] w-[50rem] h-[50rem] bg-emerald-200 dark:bg-cyan-900 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-[140px] dark:blur-[160px] animate-blob" style="animation-delay: 6s"></div>
    </div>

    <!-- Header mit absoluter Zentrierung für die Uhr -->
    <header class="glass-panel z-20 p-4 flex justify-between items-center shrink-0 relative">
        <!-- Logo & Title (Left) -->
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 shrink-0 rounded-full bg-helios-100 dark:bg-helios-500/20 flex items-center justify-center border border-helios-300 dark:border-helios-400/50 shadow-sm dark:shadow-[0_0_15px_rgba(16,185,129,0.3)]">
                <i class="fa-solid fa-heart-pulse text-helios-600 dark:text-helios-400 text-xl dark:text-glow-green"></i>
            </div>
            <h1 class="text-xl font-bold tracking-tight text-slate-800 dark:text-white hidden md:flex items-center whitespace-nowrap">
                ER Task Radar <span class="text-helios-600 dark:text-helios-400 text-sm font-normal ml-3 tracking-widest uppercase">Helios Klinik Duisburg</span>
            </h1>
        </div>
        
        <!-- Clock & Weather (Absolute Center) -->
        <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex flex-col items-center justify-center pointer-events-none">
            <div id="clock" class="text-3xl md:text-5xl font-bold font-mono text-helios-700 dark:text-white dark:text-glow-green tracking-tighter drop-shadow-md">00:00:00</div>
            <div class="flex items-center gap-3 mt-1">
                <div id="date" class="text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-widest drop-shadow-sm">Datum</div>
                <div class="w-1 h-1 rounded-full bg-slate-400 dark:bg-slate-500"></div>
                <!-- Weather Widget -->
                <div id="weather" class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest drop-shadow-sm flex items-center gap-1.5">
                    <i class="fa-solid fa-spinner fa-spin"></i>
                </div>
            </div>
        </div>

        <!-- Controls (Right) -->
        <div class="flex items-center gap-4">
            <button onclick="toggleTheme()" class="w-10 h-10 rounded-full bg-white/50 dark:bg-slate-700/50 border border-white/60 dark:border-white/10 text-slate-600 dark:text-yellow-400 flex items-center justify-center hover:bg-white/80 dark:hover:bg-slate-600/80 transition backdrop-blur-md shadow-sm">
                <i class="fa-solid fa-moon dark:hidden"></i>
                <i class="fa-solid fa-sun hidden dark:block"></i>
            </button>

            <button onclick="clearAllData()" class="bg-white/50 dark:bg-slate-700/50 hover:bg-red-50 dark:hover:bg-red-900/40 border border-white/60 dark:border-white/10 text-slate-600 dark:text-slate-300 hover:text-red-600 dark:hover:text-red-400 px-4 py-2 rounded-lg text-sm transition font-medium flex items-center gap-2 backdrop-blur-md shadow-sm">
                <i class="fa-solid fa-power-off"></i> <span class="hidden lg:inline">Shift Reset</span>
            </button>
        </div>
    </header>

    <!-- Main Grid - Columns wrap draggable panels -->
    <main class="flex-1 p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 overflow-y-auto align-top z-10 relative" id="dashboard-grid">
        
        <!-- Column 1 -->
        <div class="panel-col flex flex-col gap-4 h-full min-h-[100px] transition-colors duration-300" id="col-0">
            <!-- Panel: Timers -->
            <div class="dashboard-panel glass-panel rounded-2xl flex flex-col max-h-full overflow-hidden" id="panel-timers">
                <div class="p-4 border-b border-white/40 dark:border-white/10 flex justify-between items-center bg-white/20 dark:bg-transparent cursor-default">
                    <h2 class="font-bold flex items-center gap-2 text-slate-800 dark:text-white drop-shadow-sm">
                        <div class="drag-handle cursor-move w-6 h-6 flex items-center justify-center text-slate-400 hover:text-slate-800 dark:hover:text-white transition rounded hover:bg-white/30 dark:hover:bg-white/10 -ml-1"><i class="fa-solid fa-grip-vertical"></i></div>
                        <i class="fa-solid fa-stopwatch text-helios-600 dark:text-helios-400"></i> Aktive Timer
                    </h2>
                </div>
                
                <div class="p-4 border-b border-white/40 dark:border-white/10 space-y-3 bg-white/10 dark:bg-white/5">
                    <input type="text" id="timerPatient" placeholder="Patient / Zimmer / Bett" class="w-full text-sm p-2.5 rounded-lg glass-input outline-none text-slate-800 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                    <input list="taskOptions" id="timerTask" placeholder="Was? (z.B. Labor, Re-Eval)" class="w-full text-sm p-2.5 rounded-lg glass-input outline-none text-slate-800 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                    <datalist id="taskOptions">
                        <option value="Labor (allg.)"><option value="Troponin"><option value="CRP"><option value="Abstriche"><option value="Blutkulturen"><option value="BGA"><option value="Urin"><option value="Analgesie Re-Eval"><option value="EKG"><option value="Arztinfo">
                    </datalist>
                    <div class="flex gap-2">
                        <button onclick="addTimer(20)" class="flex-1 glass-input hover:bg-white/80 dark:hover:bg-helios-500/20 text-slate-700 dark:text-slate-300 hover:text-helios-700 dark:hover:text-white text-xs py-2 rounded-lg transition font-bold shadow-sm">20m</button>
                        <button onclick="addTimer(45)" class="flex-1 glass-input hover:bg-white/80 dark:hover:bg-helios-500/20 text-slate-700 dark:text-slate-300 hover:text-helios-700 dark:hover:text-white text-xs py-2 rounded-lg transition font-bold shadow-sm">45m</button>
                        <button onclick="addTimer(60)" class="flex-1 glass-input hover:bg-white/80 dark:hover:bg-helios-500/20 text-slate-700 dark:text-slate-300 hover:text-helios-700 dark:hover:text-white text-xs py-2 rounded-lg transition font-bold shadow-sm">60m</button>
                        <input type="number" id="timerCustom" placeholder="Min" class="w-16 text-sm p-2 rounded-lg glass-input outline-none text-center text-slate-800 dark:text-white shadow-sm">
                        <button onclick="addCustomTimer()" class="bg-helios-600 hover:bg-helios-500 text-white dark:bg-helios-500/40 dark:hover:bg-helios-500/60 dark:border dark:border-helios-400/50 dark:text-white px-3 py-1 rounded-lg transition shadow-md dark:shadow-[0_0_15px_rgba(16,185,129,0.3)]"><i class="fa-solid fa-plus"></i></button>
                    </div>
                </div>

                <div id="timerList" class="p-4 overflow-y-auto flex-1 space-y-4 custom-scrollbar bg-white/5 dark:bg-transparent">
                    <!-- Timers injected here -->
                </div>
            </div>
        </div>

        <!-- Column 2 -->
        <div class="panel-col flex flex-col gap-4 h-full min-h-[100px] transition-colors duration-300" id="col-1">
            <!-- Panel: Transports -->
            <div class="dashboard-panel glass-panel rounded-2xl flex flex-col overflow-hidden shrink-0" id="panel-transports">
                <div class="p-4 border-b border-white/40 dark:border-white/10 flex justify-between items-center bg-white/20 dark:bg-transparent cursor-default">
                    <h2 class="font-bold flex items-center gap-2 text-slate-800 dark:text-white drop-shadow-sm">
                        <div class="drag-handle cursor-move w-6 h-6 flex items-center justify-center text-slate-400 hover:text-slate-800 dark:hover:text-white transition rounded hover:bg-white/30 dark:hover:bg-white/10 -ml-1"><i class="fa-solid fa-grip-vertical"></i></div>
                        <i class="fa-solid fa-bed-pulse text-indigo-500 dark:text-indigo-400"></i> Transport Radar
                    </h2>
                </div>
                
                <div class="p-4 border-b border-white/40 dark:border-white/10 space-y-3 bg-white/10 dark:bg-white/5">
                    <input type="text" id="transPatient" placeholder="Patient / Zimmer" class="w-full text-sm p-2.5 rounded-lg glass-input outline-none text-slate-800 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                    <div class="flex gap-2">
                        <input list="zielOptions" id="transZiel" placeholder="Ziel..." class="flex-1 w-full text-sm p-2.5 rounded-lg glass-input outline-none text-slate-800 dark:text-white font-medium placeholder-slate-400 dark:placeholder-slate-500">
                        <datalist id="zielOptions">
                            <option value="Entlassung / Heim"><option value="Rücktransport"><option value="Verlegung Extern"><option value="Verlegung Intern"><option value="CT"><option value="Röntgen"><option value="Station"><option value="OP"><option value="Herzkatheter">
                        </datalist>
                        <input type="time" id="transTime" title="Ziel-Uhrzeit (leer = sofort)" class="w-26 text-sm p-2.5 rounded-lg glass-input outline-none text-center text-slate-800 dark:text-white">
                    </div>
                    <button onclick="addTransport()" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white dark:bg-indigo-500/30 dark:hover:bg-indigo-500/50 dark:border dark:border-indigo-400/50 dark:text-white text-sm py-2.5 rounded-lg transition font-bold shadow-md dark:shadow-[0_0_15px_rgba(99,102,241,0.3)]"><i class="fa-solid fa-truck-medical mr-2"></i> Transport anlegen</button>
                </div>

                <div id="transportList" class="p-4 overflow-y-auto max-h-[300px] space-y-3 custom-scrollbar bg-white/5 dark:bg-transparent">
                    <!-- Transports injected here -->
                </div>
            </div>

            <!-- NEW Panel: SOP & SR Log -->
            <div class="dashboard-panel glass-panel rounded-2xl flex flex-col flex-1 overflow-hidden" id="panel-soplog">
                <div class="p-3 border-b border-white/40 dark:border-white/10 flex justify-between items-center bg-purple-50/50 dark:bg-purple-900/10 cursor-default shrink-0">
                    <h2 class="font-bold flex items-center gap-2 text-purple-700 dark:text-purple-400 text-sm drop-shadow-sm">
                        <div class="drag-handle cursor-move w-6 h-6 flex items-center justify-center text-purple-400 hover:text-purple-600 dark:hover:text-purple-300 transition rounded hover:bg-purple-200/50 dark:hover:bg-purple-900/40 -ml-1"><i class="fa-solid fa-grip-vertical"></i></div>
                        <i class="fa-solid fa-clipboard-list"></i> SOP & SR Log
                    </h2>
                </div>
                
                <div class="p-3 bg-white/10 dark:bg-white/5 space-y-2 shrink-0 border-b border-white/40 dark:border-white/10">
                    <select id="sopSelect" class="w-full text-xs font-bold p-2 rounded-lg glass-input outline-none text-slate-800 dark:text-white cursor-pointer" onchange="updateSOPView()">
                        <option value="">-- Wähle Top 10 SOP --</option>
                        <option value="Reanimation">1. Reanimation (ALS)</option>
                        <option value="Polytrauma">2. Polytrauma</option>
                        <option value="STEMI">3. STEMI / ACS</option>
                        <option value="Stroke">4. Stroke / Apoplex</option>
                        <option value="Sepsis">5. Sepsis</option>
                        <option value="Anaphylaxie">6. Anaphylaxie</option>
                        <option value="StatusEpilepticus">7. Status Epilepticus</option>
                        <option value="Lungenembolie">8. Lungenembolie</option>
                        <option value="Hyperkaliämie">9. Hyperkaliämie</option>
                        <option value="Atemnot">10. Akute Atemnot (COPD/Asthma)</option>
                    </select>
                    
                    <div id="sopFacts" class="text-[10px] font-medium text-slate-700 dark:text-slate-300 bg-white/60 dark:bg-black/20 p-2 rounded-lg border border-white/80 dark:border-white/10 min-h-[40px] flex items-center shadow-sm">
                        SOP auswählen für Hard Facts...
                    </div>
                    
                    <div class="flex gap-2 pt-1">
                        <input type="text" id="srCustomInput" placeholder="Freitext Log..." class="flex-1 text-[10px] p-2 rounded glass-input outline-none text-slate-800 dark:text-white" onkeypress="if(event.key === 'Enter') addSrLogCustom()">
                        <button onclick="addSrLogCustom()" class="bg-purple-600 hover:bg-purple-500 text-white px-3 py-1.5 rounded transition text-[10px] font-bold shadow-sm"><i class="fa-solid fa-check"></i></button>
                    </div>

                    <div id="sopActionBtns" class="flex flex-wrap gap-1.5 mt-1">
                        <!-- Dynamic Buttons injected here based on SOP -->
                    </div>
                </div>

                <div class="flex-1 overflow-y-auto p-2 bg-white/5 dark:bg-transparent custom-scrollbar space-y-1" id="srLogList">
                    <!-- Logs go here -->
                </div>

                <div class="p-2 border-t border-white/40 dark:border-white/10 flex gap-2 shrink-0 bg-white/10 dark:bg-white/5">
                    <button onclick="copySrLog()" class="flex-1 py-1.5 bg-slate-800 hover:bg-slate-700 text-white dark:bg-white/10 dark:hover:bg-white/20 rounded transition text-[10px] font-bold flex justify-center items-center gap-1.5 shadow-sm"><i class="fa-regular fa-copy"></i> Log Kopieren</button>
                    <button onclick="clearSrLog()" class="px-3 py-1.5 glass-input text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/40 rounded transition text-[10px] font-bold"><i class="fa-solid fa-trash"></i></button>
                </div>
            </div>
        </div>

        <!-- Column 3 -->
        <div class="panel-col flex flex-col gap-4 h-full min-h-[100px] transition-colors duration-300" id="col-2">
            <!-- Panel: Vitals -->
            <div class="dashboard-panel glass-panel rounded-2xl flex flex-col max-h-full overflow-hidden" id="panel-vitals">
                <div class="p-4 border-b border-white/40 dark:border-white/10 flex justify-between items-center bg-white/20 dark:bg-transparent cursor-default">
                    <h2 class="font-bold flex items-center gap-2 text-slate-800 dark:text-white drop-shadow-sm">
                        <div class="drag-handle cursor-move w-6 h-6 flex items-center justify-center text-slate-400 hover:text-slate-800 dark:hover:text-white transition rounded hover:bg-white/30 dark:hover:bg-white/10 -ml-1"><i class="fa-solid fa-grip-vertical"></i></div>
                        <i class="fa-solid fa-heartbeat text-pink-500 dark:text-pink-400"></i> Vital Zwischenablage
                    </h2>
                </div>
                
                <div class="p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar bg-white/5 dark:bg-transparent">
                    <div>
                        <label class="text-xs font-bold text-slate-500 dark:text-slate-400 mb-1.5 block tracking-wide">Patienten Info optional</label>
                        <input type="text" id="vitPatient" placeholder="Name oder Raum" class="w-full text-sm p-2.5 rounded-lg glass-input outline-none text-slate-800 dark:text-white placeholder-slate-400">
                    </div>
                    
                    <div>
                        <label class="text-xs font-bold text-red-500 dark:text-red-400 mb-1.5 block uppercase tracking-widest drop-shadow-sm"><i class="fa-solid fa-triangle-exclamation"></i> Allergien</label>
                        <input type="text" id="vitAllergies" placeholder="Keine bekannt / Penicillin..." class="w-full text-sm p-2.5 rounded-lg bg-red-50/50 dark:bg-red-900/20 border border-red-300 dark:border-red-500/40 focus:border-red-500 outline-none text-slate-800 dark:text-white backdrop-blur-md shadow-sm transition placeholder-red-300 dark:placeholder-red-400/50">
                        <div class="flex flex-wrap gap-1.5 mt-2">
                            <button onclick="addAllergy('Penicillin')" class="text-[10px] font-bold bg-white/60 dark:bg-red-900/40 text-red-700 dark:text-red-300 px-2 py-1 rounded border border-red-200 dark:border-red-500/30 hover:bg-white dark:hover:bg-red-900/60 transition backdrop-blur-sm shadow-sm">Penicillin</button>
                            <button onclick="addAllergy('Novalgin')" class="text-[10px] font-bold bg-white/60 dark:bg-red-900/40 text-red-700 dark:text-red-300 px-2 py-1 rounded border border-red-200 dark:border-red-500/30 hover:bg-white dark:hover:bg-red-900/60 transition backdrop-blur-sm shadow-sm">Novalgin</button>
                            <button onclick="addAllergy('Pflaster')" class="text-[10px] font-bold bg-white/60 dark:bg-red-900/40 text-red-700 dark:text-red-300 px-2 py-1 rounded border border-red-200 dark:border-red-500/30 hover:bg-white dark:hover:bg-red-900/60 transition backdrop-blur-sm shadow-sm">Pflaster</button>
                            <button onclick="addAllergy('KM')" class="text-[10px] font-bold bg-white/60 dark:bg-red-900/40 text-red-700 dark:text-red-300 px-2 py-1 rounded border border-red-200 dark:border-red-500/30 hover:bg-white dark:hover:bg-red-900/60 transition backdrop-blur-sm shadow-sm">KM</button>
                            <button onclick="addAllergy('Latex')" class="text-[10px] font-bold bg-white/60 dark:bg-red-900/40 text-red-700 dark:text-red-300 px-2 py-1 rounded border border-red-200 dark:border-red-500/30 hover:bg-white dark:hover:bg-red-900/60 transition backdrop-blur-sm shadow-sm">Latex</button>
                            <button onclick="setAllergy('Keine bekannt')" class="text-[10px] font-bold bg-emerald-100/60 dark:bg-emerald-900/40 text-emerald-700 dark:text-emerald-300 px-2 py-1 rounded border border-emerald-200 dark:border-emerald-500/30 hover:bg-emerald-100 dark:hover:bg-emerald-900/60 transition backdrop-blur-sm shadow-sm">Keine</button>
                        </div>
                    </div>

                    <div class="grid grid-cols-3 gap-3">
                        <div>
                            <label class="text-xs font-bold text-slate-500 dark:text-slate-400 mb-1.5 block tracking-wide">RR mmHg</label>
                            <input type="text" id="vitRR" placeholder="120/80" class="w-full text-base font-mono p-2.5 rounded-lg glass-input outline-none text-center text-helios-700 dark:text-helios-400 placeholder-slate-300 dark:placeholder-slate-600 font-bold">
                        </div>
                        <div>
                            <label class="text-xs font-bold text-slate-500 dark:text-slate-400 mb-1.5 block tracking-wide">HF /min</label>
                            <input type="number" id="vitHF" placeholder="80" class="w-full text-base font-mono p-2.5 rounded-lg glass-input outline-none text-center text-helios-700 dark:text-helios-400 placeholder-slate-300 dark:placeholder-slate-600 font-bold">
                        </div>
                        <div>
                            <label class="text-xs font-bold text-slate-500 dark:text-slate-400 mb-1.5 block tracking-wide">AF /min</label>
                            <input type="number" id="vitAF" placeholder="15" class="w-full text-base font-mono p-2.5 rounded-lg glass-input outline-none text-center text-helios-700 dark:text-helios-400 placeholder-slate-300 dark:placeholder-slate-600 font-bold">
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="text-xs font-bold text-slate-500 dark:text-slate-400 mb-1.5 block tracking-wide">SpO2 %</label>
                            <input type="number" id="vitSpO2" placeholder="98" class="w-full text-base font-mono p-2.5 rounded-lg glass-input outline-none text-center text-helios-700 dark:text-helios-400 placeholder-slate-300 dark:placeholder-slate-600 font-bold">
                        </div>
                        <div>
                            <label class="text-xs font-bold text-slate-500 dark:text-slate-400 mb-1.5 block tracking-wide">Temp °C</label>
                            <input type="number" step="0.1" id="vitTemp" placeholder="37.0" class="w-full text-base font-mono p-2.5 rounded-lg glass-input outline-none text-center text-helios-700 dark:text-helios-400 placeholder-slate-300 dark:placeholder-slate-600 font-bold">
                        </div>
                    </div>
                    <div>
                        <label class="text-xs font-bold text-slate-500 dark:text-slate-400 mb-1.5 block tracking-wide">GCS / BZ / Sonstiges</label>
                        <input type="text" id="vitMisc" placeholder="BZ 120, GCS 15..." class="w-full text-sm p-2.5 rounded-lg glass-input outline-none text-slate-800 dark:text-white placeholder-slate-400">
                    </div>
                    
                    <div class="pt-2 flex gap-3">
                        <button onclick="copyVitals()" class="flex-1 bg-slate-800 hover:bg-slate-700 text-white dark:bg-white/10 dark:hover:bg-white/20 dark:border dark:border-white/30 py-2.5 rounded-lg transition font-bold text-sm flex justify-center items-center gap-2 shadow-md backdrop-blur-md">
                            <i class="fa-regular fa-copy"></i> Kopieren
                        </button>
                        <button onclick="clearVitals()" class="glass-input hover:bg-red-50 dark:hover:bg-red-900/40 text-slate-700 hover:text-red-600 dark:text-red-400 px-4 py-2.5 rounded-lg transition shadow-sm">
                            <i class="fa-solid fa-eraser"></i>
                        </button>
                    </div>
                    <div id="copyToast" class="hidden text-center text-xs font-bold text-helios-700 bg-helios-100/80 border border-helios-300 dark:text-helios-300 dark:bg-helios-500/20 dark:border-helios-400/50 p-2.5 rounded-lg mt-2 backdrop-blur-md shadow-lg">Kopiert für Orbis!</div>
                </div>
            </div>
        </div>

        <!-- Column 4 -->
        <div class="panel-col flex flex-col gap-4 h-full min-h-[100px] transition-colors duration-300 lg:col-span-1" id="col-3">
            
            <!-- Panel: Quick Timer & Stopwatch -->
            <div class="dashboard-panel glass-panel rounded-2xl flex flex-col shrink-0 overflow-hidden" id="panel-quicktimer">
                <div class="p-3 border-b border-white/40 dark:border-white/10 flex justify-between items-center bg-sky-50/50 dark:bg-sky-900/10 cursor-default">
                    <h2 class="font-bold flex items-center gap-2 text-sky-700 dark:text-sky-400 text-sm drop-shadow-sm">
                        <div class="drag-handle cursor-move w-6 h-6 flex items-center justify-center text-sky-400 hover:text-sky-600 dark:hover:text-sky-300 transition rounded hover:bg-sky-200/50 dark:hover:bg-sky-900/40 -ml-1"><i class="fa-solid fa-grip-vertical"></i></div>
                        <i class="fa-solid fa-stopwatch"></i> Timer / Stoppuhr
                    </h2>
                    <div class="font-mono text-xl font-bold text-sky-600 dark:text-sky-400 drop-shadow-sm tracking-wider" id="qtDisplay">00:00</div>
                </div>
                <div class="p-2 flex gap-2 bg-white/20 dark:bg-white/5">
                    <input type="number" id="qtInput" placeholder="Min" title="Zahl = Timer | Leer = Stoppuhr" class="w-16 text-sm p-2 rounded-lg glass-input text-center outline-none text-slate-800 dark:text-white">
                    <button onclick="toggleQuickTimer()" id="qtToggleBtn" class="flex-1 bg-sky-600 hover:bg-sky-500 text-white text-xs py-2 rounded-lg transition font-bold shadow-md flex items-center justify-center gap-1.5"><i class="fa-solid fa-play"></i> Start</button>
                    <button onclick="resetQuickTimer()" class="w-10 glass-input hover:bg-red-100 dark:hover:bg-red-900/40 text-red-700 dark:text-red-400 text-xs py-2 rounded-lg transition font-bold flex items-center justify-center"><i class="fa-solid fa-rotate-left"></i></button>
                </div>
            </div>

            <!-- Panel: Checkliste -->
            <div class="dashboard-panel glass-panel rounded-2xl flex flex-col flex-1 overflow-hidden min-h-[200px]" id="panel-checklist">
                <div class="p-4 border-b border-white/40 dark:border-white/10 flex justify-between items-center bg-white/20 dark:bg-transparent cursor-default">
                    <h2 class="font-bold flex items-center gap-2 text-slate-800 dark:text-white drop-shadow-sm">
                        <div class="drag-handle cursor-move w-6 h-6 flex items-center justify-center text-slate-400 hover:text-slate-800 dark:hover:text-white transition rounded hover:bg-white/30 dark:hover:bg-white/10 -ml-1"><i class="fa-solid fa-grip-vertical"></i></div>
                        <i class="fa-solid fa-list-check text-amber-500 dark:text-amber-400"></i> Checkliste
                    </h2>
                    <span class="text-[10px] text-slate-600 dark:text-slate-300 font-bold uppercase tracking-widest bg-white/40 dark:bg-white/10 px-2 py-1 rounded backdrop-blur-sm border border-white/50 dark:border-white/10">Auto Save</span>
                </div>
                <div class="p-4 flex-1 flex flex-col overflow-hidden bg-white/5 dark:bg-transparent">
                    <div class="flex gap-2 mb-4">
                        <input type="text" id="newTaskInput" placeholder="Neue Aufgabe..." class="w-full text-sm p-2.5 rounded-lg glass-input outline-none text-slate-800 dark:text-white placeholder-slate-400" onkeypress="if(event.key === 'Enter') addTask()">
                        <button onclick="addTask()" class="bg-amber-500 hover:bg-amber-400 text-white dark:bg-amber-500/40 dark:hover:bg-amber-500/60 dark:border dark:border-amber-400/50 px-4 rounded-lg transition font-bold shadow-md dark:shadow-[0_0_15px_rgba(245,158,11,0.2)]"><i class="fa-solid fa-plus"></i></button>
                    </div>
                    <div id="taskList" class="flex-1 overflow-y-auto space-y-2 custom-scrollbar pr-1 mb-2 pb-4">
                        <!-- Tasks injected here -->
                    </div>
                </div>
            </div>

            <!-- Panel: Notizen -->
            <div class="dashboard-panel glass-panel rounded-2xl flex flex-col shrink-0 h-[250px] overflow-hidden" id="panel-notes">
                <div class="p-4 border-b border-white/40 dark:border-white/10 flex justify-between items-center bg-white/20 dark:bg-transparent cursor-default">
                    <h2 class="font-bold flex items-center gap-2 text-slate-800 dark:text-white drop-shadow-sm">
                        <div class="drag-handle cursor-move w-6 h-6 flex items-center justify-center text-slate-400 hover:text-slate-800 dark:hover:text-white transition rounded hover:bg-white/30 dark:hover:bg-white/10 -ml-1"><i class="fa-solid fa-grip-vertical"></i></div>
                        <i class="fa-regular fa-note-sticky text-yellow-500 dark:text-yellow-400"></i> Notizen
                    </h2>
                    <span class="text-[10px] text-slate-600 dark:text-slate-300 font-bold uppercase tracking-widest bg-white/40 dark:bg-white/10 px-2 py-1 rounded backdrop-blur-sm border border-white/50 dark:border-white/10">Auto Save</span>
                </div>
                <div class="p-4 flex-1 flex flex-col overflow-hidden bg-white/5 dark:bg-transparent">
                    <textarea id="notesArea" placeholder="Schnelle Notizen, Übergabe-Infos..." class="w-full h-full p-3 rounded-lg glass-input outline-none text-slate-800 dark:text-white placeholder-slate-400 resize-none custom-scrollbar text-sm" oninput="saveNotes()"></textarea>
                </div>
            </div>

        </div>

    </main>

    <script>
        // ----------------------------------------------------
        // SOP DATA
        // ----------------------------------------------------
        const sopData = {
            "Reanimation": { facts: "Adrenalin 1mg i.v. alle 3-5 Min | Amiodaron 300mg nach 3. Schock | H&Hs checken", actions: ["CPR Start", "Rhythmuskontrolle", "Schockabgabe", "Adrenalin 1mg", "Amiodaron 300mg", "ROSC"] },
            "Polytrauma": { facts: "Ziel-RR >90 (SHT >110) | Tranexamsäure 1g i.v. frühzeitig | Beckenschlinge | eFAST", actions: ["SR Start", "eFAST positiv", "TXA 1g", "EK Gabe", "Intubation", "CT Transport"] },
            "STEMI": { facts: "ASS 250mg i.v. | Heparin 5000 IE i.v. | O2 nur bei SpO2 < 90% | P2Y12 Hemmer n.R.", actions: ["12-Kanal EKG", "ASS 250mg", "Heparin 5000iE", "Schmerztherapie", "Labor & Trop", "HKL Anmeldung"] },
            "Stroke": { facts: "Zeitfenster Lyse 4.5h! | RR-Ziel < 185/110 mmHg vor Lyse | BZ messen!", actions: ["Symptombeginn erfragt", "Neuro Status (NIHSS)", "BZ gemessen", "CT Nativ", "Lyse Start"] },
            "Sepsis": { facts: "qSOFA? | Blutkulturen VOR Antibiose | Breitband-AB in < 1h | 30ml/kg kristalloide Lsg", actions: ["Blutkulturen abgenommen", "Antibiose angehängt", "Volumengabe Start", "Laktat gemessen", "BGA"] },
            "Anaphylaxie": { facts: "Adrenalin 0.5mg i.m. (Oberschenkel!) | H1/H2 Blocker | Volumengabe | O2", actions: ["Adrenalin i.m.", "Fenistil/Tavegil", "Cortison i.v.", "Volumen Start", "Atemwege gesichert"] },
            "StatusEpilepticus": { facts: "Lorazepam (Tavor) 2-4mg i.v. (langsam) | Alternativ: Midazolam i.n./i.m. | O2", actions: ["O2 Gabe", "Lorazepam i.v.", "Midazolam", "Leve/Valproat", "Intubation"] },
            "Lungenembolie": { facts: "Heparin Bolus (5000 IE oder gewichtsadaptiert) | O2 Gabe | Echo erwägen (Re-Herz Belastung?)", actions: ["Heparin Bolus", "BGA", "O2 Anlage", "CT-Angio Anmeldung", "Lyse erwogen"] },
            "Hyperkaliämie": { facts: "EKG Check! (Zelt-T?) | Calciumgluconat 10% (Herzschutz) | Glukose 10% + 10 IE Alt-Insulin", actions: ["EKG geschrieben", "Calciumgluconat", "Glukose+Insulin", "Salbutamol Inhal.", "BGA Kontrolle"] },
            "Atemnot": { facts: "Salbutamol/Atrovent Inhalation | Cortison i.v. | NIV frühzeitig erwägen (COPD)", actions: ["Sitzende Lagerung", "O2 / NIV", "Inhalation Start", "Cortison i.v.", "BGA"] }
        };

        const defaultActions = ["Zugang gelegt", "Labor abgenommen", "Arzt Info", "BGA", "EKG"];

        // State Management
        let appData = {
            timers: [],
            transports: [],
            tasks: [],
            notes: "",
            layout: [], 
            qt: { mode: 'idle', endTime: 0, startTime: 0, elapsed: 0, running: false },
            srLog: [],
            selectedSOP: ""
        };

        let audioUnlocked = false;

        function playGong() {
            const gong = document.getElementById('gongSound');
            if(gong) { gong.volume = 1.0; gong.play().catch(err => console.log("Audio blockiert")); }
        }

        document.body.addEventListener('click', function unlockAudio() {
            if(!audioUnlocked) {
                const gong = document.getElementById('gongSound');
                if(gong) { gong.volume = 0; gong.play().then(() => { gong.pause(); gong.currentTime = 0; audioUnlocked = true; }).catch(e => {}); }
            }
        }, { once: true });

        function toggleTheme() {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
        }

        async function fetchWeather() {
            const weatherEl = document.getElementById('weather');
            if(!weatherEl) return;
            try {
                const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=51.4324&longitude=6.7651&current=temperature_2m,weather_code');
                const data = await res.json();
                const temp = Math.round(data.current.temperature_2m);
                const code = data.current.weather_code;
                
                let iconClass = 'fa-sun text-yellow-500 dark:text-yellow-400'; 
                if (code >= 1 && code <= 3) iconClass = 'fa-cloud-sun text-slate-400';
                else if (code >= 45 && code <= 48) iconClass = 'fa-smog text-slate-400';
                else if (code >= 51 && code <= 67) iconClass = 'fa-cloud-rain text-blue-500';
                else if (code >= 71 && code <= 77) iconClass = 'fa-snowflake text-sky-400';
                else if (code >= 80 && code <= 82) iconClass = 'fa-cloud-showers-heavy text-blue-600';
                else if (code >= 95 && code <= 99) iconClass = 'fa-cloud-bolt text-purple-600';

                weatherEl.innerHTML = `<i class="fa-solid ${iconClass}"></i> ${temp}°C`;
            } catch (err) {
                weatherEl.innerHTML = `<i class="fa-solid fa-cloud"></i> --°C`;
            }
        }

        // Init & Loop
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            startClock();
            fetchWeather();
            initPanelDragAndDrop();
            updateSOPView(true); // initialize SOP view
            renderSrLog();
            
            setInterval(fetchWeather, 1800000); 
            setInterval(updateAllTimers, 1000);
            
            if(appData.qt.running) {
                qtInterval = setInterval(updateQuickTimer, 100);
                const btn = document.getElementById('qtToggleBtn');
                btn.innerHTML = '<i class="fa-solid fa-pause"></i> Pause';
                btn.classList.replace('bg-sky-600', 'bg-amber-500');
                btn.classList.replace('hover:bg-sky-500', 'hover:bg-amber-400');
            } else if (appData.qt.mode !== 'idle') {
                updateQuickTimerDisplay(); 
                const btn = document.getElementById('qtToggleBtn');
                btn.innerHTML = '<i class="fa-solid fa-play"></i> Start';
            }
        });

        function startClock() {
            setInterval(() => {
                const now = new Date();
                document.getElementById('clock').innerText = now.toLocaleTimeString('de-DE');
                document.getElementById('date').innerText = now.toLocaleDateString('de-DE', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            }, 1000);
        }

        // Data Persistence
        function saveData() { localStorage.setItem('erTaskRadar', JSON.stringify(appData)); }

        function loadData() {
            const saved = localStorage.getItem('erTaskRadar');
            if (saved) {
                const parsed = JSON.parse(saved);
                appData.timers = parsed.timers || [];
                appData.transports = parsed.transports || [];
                appData.tasks = parsed.tasks || [];
                appData.notes = parsed.notes || "";
                appData.layout = parsed.layout || [];
                appData.srLog = parsed.srLog || [];
                appData.selectedSOP = parsed.selectedSOP || "";
                
                if (parsed.qtEndTime && parsed.qtEndTime > Date.now()) {
                    appData.qt = { mode: 'timer', endTime: parsed.qtEndTime, startTime: 0, elapsed: 0, running: true };
                } else {
                    appData.qt = parsed.qt || { mode: 'idle', endTime: 0, startTime: 0, elapsed: 0, running: false };
                }

                document.getElementById('notesArea').value = appData.notes;
                document.getElementById('sopSelect').value = appData.selectedSOP;

                renderTimers();
                renderTransports();
                renderTasks();
                applyLayout();
            }
        }

        function clearAllData() {
            if(confirm('Achtung: Willst du wirklich alle Patientendaten und Protokolle dieser Schicht löschen? Dein Layout bleibt erhalten.')) {
                appData.timers = [];
                appData.transports = [];
                appData.tasks = [];
                appData.notes = "";
                appData.srLog = [];
                clearVitals();
                resetQuickTimer();
                document.getElementById('notesArea').value = "";
                saveData();
                renderTimers();
                renderTransports();
                renderTasks();
                renderSrLog();
            }
        }

        // ----------------------------------------------------
        // SOP & SR LOG LOGIC
        // ----------------------------------------------------
        function updateSOPView(isInit = false) {
            const select = document.getElementById('sopSelect');
            if(!isInit) {
                appData.selectedSOP = select.value;
                saveData();
            }
            const key = appData.selectedSOP;
            const factsEl = document.getElementById('sopFacts');
            const btnsEl = document.getElementById('sopActionBtns');
            
            btnsEl.innerHTML = '';
            
            if (key && sopData[key]) {
                const data = sopData[key];
                // Render Facts with slight formatting
                factsEl.innerHTML = `<span class="text-purple-600 dark:text-purple-400 mr-1"><i class="fa-solid fa-bolt"></i></span> ` + data.facts;
                
                // Render SOP Specific Buttons
                data.actions.forEach(action => {
                    btnsEl.innerHTML += `<button onclick="addSrLog('${action}')" class="bg-purple-100 hover:bg-purple-200 text-purple-800 dark:bg-purple-900/40 dark:hover:bg-purple-800/60 dark:text-purple-300 dark:border dark:border-purple-500/30 px-2 py-1 rounded transition text-[10px] font-bold shadow-sm">${action}</button>`;
                });
            } else {
                factsEl.innerHTML = "SOP auswählen für Hard Facts und Quick-Buttons...";
            }

            // Always add default buttons
            defaultActions.forEach(action => {
                btnsEl.innerHTML += `<button onclick="addSrLog('${action}')" class="bg-white/60 hover:bg-white text-slate-700 dark:bg-slate-800/60 dark:hover:bg-slate-700 dark:text-slate-300 dark:border dark:border-white/10 px-2 py-1 rounded transition text-[10px] font-bold shadow-sm">${action}</button>`;
            });
        }

        function addSrLogCustom() {
            const input = document.getElementById('srCustomInput');
            if(input.value.trim() !== '') {
                addSrLog(input.value.trim());
                input.value = '';
            }
        }

        function addSrLog(text) {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' });
            appData.srLog.push({ id: Date.now(), time: timeStr, text: text });
            saveData();
            renderSrLog();
        }

        function renderSrLog() {
            const list = document.getElementById('srLogList');
            list.innerHTML = '';
            if(appData.srLog.length === 0) {
                list.innerHTML = '<div class="text-center text-slate-400 dark:text-slate-500 text-[10px] py-4 font-mono">Log ist leer</div>';
                return;
            }
            
            // Reverse so newest is top or bottom? Usually logs go bottom up, but since it's a fixed window, latest at top is better.
            const sortedLogs = [...appData.srLog].sort((a,b) => b.id - a.id);
            
            sortedLogs.forEach(entry => {
                list.innerHTML += `<div class="flex items-start gap-2 text-[10px] border-b border-white/20 dark:border-white/5 pb-1"><span class="font-mono font-bold text-slate-500 dark:text-slate-400">[${entry.time}]</span><span class="font-medium text-slate-800 dark:text-slate-200">${entry.text}</span></div>`;
            });
        }

        function clearSrLog() {
            if(confirm('Protokoll wirklich leeren?')) {
                appData.srLog = [];
                saveData();
                renderSrLog();
            }
        }

        function copySrLog() {
            if(appData.srLog.length === 0) return;
            const sortedLogs = [...appData.srLog].sort((a,b) => a.id - b.id); // Chronological for copy
            let text = "SCHOCKRAUM / EINSATZ PROTOKOLL\n--------------------------------\n";
            if(appData.selectedSOP) text += `SOP: ${appData.selectedSOP}\n\n`;
            
            sortedLogs.forEach(entry => {
                text += `[${entry.time}] ${entry.text}\n`;
            });
            
            navigator.clipboard.writeText(text).then(() => { 
                const toast = document.getElementById('copyToast'); 
                toast.classList.remove('hidden'); 
                setTimeout(() => toast.classList.add('hidden'), 2500); 
            }).catch(err => {
                const ta = document.createElement("textarea"); ta.value = text; document.body.appendChild(ta); ta.select(); try { document.execCommand('copy'); const toast = document.getElementById('copyToast'); toast.classList.remove('hidden'); setTimeout(() => toast.classList.add('hidden'), 2500); } catch (e) {} document.body.removeChild(ta);
            });
        }

        // ----------------------------------------------------
        // PANEL DRAG & DROP LOGIC
        // ----------------------------------------------------
        let draggedPanel = null;

        function initPanelDragAndDrop() {
            document.querySelectorAll('.dashboard-panel').forEach(panel => {
                const handle = panel.querySelector('.drag-handle');
                if(handle) {
                    handle.addEventListener('mousedown', () => panel.draggable = true);
                    handle.addEventListener('mouseup', () => panel.draggable = false);
                    panel.addEventListener('mouseleave', () => panel.draggable = false);
                }

                panel.addEventListener('dragstart', function(e) {
                    if(!this.draggable) { e.preventDefault(); return; }
                    draggedPanel = this;
                    setTimeout(() => this.classList.add('panel-dragging'), 0);
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/plain', this.id);
                });

                panel.addEventListener('dragend', function() {
                    this.classList.remove('panel-dragging');
                    document.querySelectorAll('.panel-col').forEach(c => c.classList.remove('panel-drag-over'));
                    this.draggable = false;
                    draggedPanel = null;
                    saveLayout();
                });
            });

            document.querySelectorAll('.panel-col').forEach(col => {
                col.addEventListener('dragover', e => {
                    if(!draggedPanel || !draggedPanel.classList.contains('dashboard-panel')) return;
                    e.preventDefault();
                    col.classList.add('panel-drag-over');
                    
                    const afterElement = getDragAfterElement(col, e.clientY);
                    if (afterElement == null) {
                        col.appendChild(draggedPanel);
                    } else {
                        col.insertBefore(draggedPanel, afterElement);
                    }
                });
                col.addEventListener('dragleave', () => {
                    if(draggedPanel && draggedPanel.classList.contains('dashboard-panel')) {
                        col.classList.remove('panel-drag-over');
                    }
                });
                col.addEventListener('drop', () => col.classList.remove('panel-drag-over'));
            });
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.dashboard-panel:not(.panel-dragging)')];
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        function saveLayout() {
            const layout = [];
            document.querySelectorAll('.panel-col').forEach(col => {
                layout.push([...col.querySelectorAll('.dashboard-panel')].map(p => p.id));
            });
            appData.layout = layout;
            saveData();
        }

        function applyLayout() {
            // Include new panel ID if missing from old saved layout
            if(appData.layout && appData.layout.length > 0) {
               let foundSopLog = false;
               appData.layout.forEach(col => { if(col.includes('panel-soplog')) foundSopLog = true; });
               if(!foundSopLog && appData.layout[1]) appData.layout[1].push('panel-soplog'); // Push to col 2 by default
            }

            if (!appData.layout || appData.layout.length === 0) return;
            const cols = document.querySelectorAll('.panel-col');
            appData.layout.forEach((panelIds, i) => {
                if(cols[i]) {
                    panelIds.forEach(id => {
                        const p = document.getElementById(id);
                        if(p) cols[i].appendChild(p);
                    });
                }
            });
        }

        // ----------------------------------------------------
        // QUICK TIMER & STOPWATCH LOGIC
        // ----------------------------------------------------
        let qtInterval = null;

        function toggleQuickTimer() {
            if(!audioUnlocked) {
                const gong = document.getElementById('gongSound');
                if(gong) { gong.volume = 0; gong.play().then(()=>{gong.pause(); audioUnlocked=true;}).catch(e=>{}); }
            }

            const input = document.getElementById('qtInput');
            const btn = document.getElementById('qtToggleBtn');
            const qt = appData.qt;

            if (qt.running) {
                // PAUSE
                qt.running = false;
                if (qt.mode === 'timer') {
                    qt.elapsed = qt.endTime - Date.now(); 
                } else if (qt.mode === 'stopwatch') {
                    qt.elapsed += Date.now() - qt.startTime; 
                }
                clearInterval(qtInterval);
                btn.innerHTML = '<i class="fa-solid fa-play"></i> Start';
                btn.classList.replace('bg-amber-500', 'bg-sky-600');
                btn.classList.replace('hover:bg-amber-400', 'hover:bg-sky-500');
            } else {
                // START / RESUME
                if (qt.mode === 'idle') {
                    const mins = parseFloat(input.value);
                    if (!isNaN(mins) && mins > 0) {
                        qt.mode = 'timer';
                        qt.endTime = Date.now() + (mins * 60000);
                    } else {
                        qt.mode = 'stopwatch';
                        qt.startTime = Date.now();
                        qt.elapsed = 0;
                    }
                    input.value = ''; 
                } else {
                    if (qt.mode === 'timer') qt.endTime = Date.now() + qt.elapsed; 
                    else if (qt.mode === 'stopwatch') qt.startTime = Date.now();
                }
                
                qt.running = true;
                if(qtInterval) clearInterval(qtInterval);
                qtInterval = setInterval(updateQuickTimer, 100);
                
                btn.innerHTML = '<i class="fa-solid fa-pause"></i> Pause';
                btn.classList.replace('bg-sky-600', 'bg-amber-500');
                btn.classList.replace('hover:bg-sky-500', 'hover:bg-amber-400');
                document.getElementById('panel-quicktimer').classList.remove('animate-pulse-red-glow');
            }
            saveData();
            updateQuickTimerDisplay();
        }

        function resetQuickTimer() {
            appData.qt = { mode: 'idle', endTime: 0, startTime: 0, elapsed: 0, running: false };
            if(qtInterval) clearInterval(qtInterval);
            saveData();
            
            const btn = document.getElementById('qtToggleBtn');
            btn.innerHTML = '<i class="fa-solid fa-play"></i> Start';
            btn.className = "flex-1 bg-sky-600 hover:bg-sky-500 text-white text-xs py-2 rounded-lg transition font-bold shadow-md flex items-center justify-center gap-1.5";
            
            document.getElementById('qtDisplay').innerText = "00:00";
            document.getElementById('panel-quicktimer').classList.remove('animate-pulse-red-glow');
            document.getElementById('qtInput').value = '';
        }

        function updateQuickTimer() {
            const qt = appData.qt;
            if (!qt.running) return;

            if (qt.mode === 'timer') {
                const diff = qt.endTime - Date.now();
                if (diff <= 0) {
                    qt.running = false;
                    qt.mode = 'idle';
                    clearInterval(qtInterval);
                    document.getElementById('qtDisplay').innerText = "00:00";
                    
                    const panel = document.getElementById('panel-quicktimer');
                    if(!panel.classList.contains('animate-pulse-red-glow')) {
                        panel.classList.add('animate-pulse-red-glow');
                        playGong();
                    }
                    
                    const btn = document.getElementById('qtToggleBtn');
                    btn.innerHTML = '<i class="fa-solid fa-play"></i> Start';
                    btn.className = "flex-1 bg-sky-600 hover:bg-sky-500 text-white text-xs py-2 rounded-lg transition font-bold shadow-md flex items-center justify-center gap-1.5";
                    saveData();
                    return;
                }
            }
            updateQuickTimerDisplay();
        }

        function updateQuickTimerDisplay() {
            const qt = appData.qt;
            const display = document.getElementById('qtDisplay');
            
            if (qt.mode === 'idle') { display.innerText = "00:00"; return; }

            let ms = 0;
            if (qt.mode === 'timer') { ms = qt.running ? qt.endTime - Date.now() : qt.elapsed; } 
            else if (qt.mode === 'stopwatch') { ms = qt.running ? qt.elapsed + (Date.now() - qt.startTime) : qt.elapsed; }

            if (ms < 0) ms = 0;

            const totalSeconds = Math.floor(ms / 1000);
            const m = Math.floor(totalSeconds / 60).toString().padStart(2, '0');
            const s = (totalSeconds % 60).toString().padStart(2, '0');
            display.innerText = `${m}:${s}`;
        }

        // ----------------------------------------------------
        // MASTER LOOP (Timers & Transports)
        // ----------------------------------------------------
        function updateAllTimers() {
            let needsRender = false;
            const now = Date.now();
            
            appData.timers.forEach(timer => {
                const elapsed = now - timer.startTime;
                const wasOverdue = timer.isOverdue;
                timer.isOverdue = elapsed >= timer.durationMs;
                if (timer.isOverdue !== wasOverdue) {
                    needsRender = true;
                    if (timer.isOverdue) playGong();
                }
            });
            
            if (needsRender) { saveData(); renderTimers(); } 
            else { updateTimerDisplays(now); }
        }

        function formatTimeDiff(ms) {
            const totalSeconds = Math.floor(Math.abs(ms) / 1000);
            const m = Math.floor(totalSeconds / 60);
            const s = totalSeconds % 60;
            return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function addTimer(minutes) {
            const patient = document.getElementById('timerPatient').value || "Unbekannt";
            const task = document.getElementById('timerTask').value || "Labor / Warten";
            appData.timers.push({ id: Date.now(), patient: patient, task: task, startTime: Date.now(), durationMs: minutes * 60 * 1000, isOverdue: false });
            saveData(); renderTimers();
            document.getElementById('timerPatient').value = ""; document.getElementById('timerTask').value = ""; document.getElementById('timerPatient').focus();
        }
        function addCustomTimer() { const mins = parseInt(document.getElementById('timerCustom').value); if(mins > 0) { addTimer(mins); document.getElementById('timerCustom').value = ""; } }
        function deleteTimer(id) { appData.timers = appData.timers.filter(t => t.id !== id); saveData(); renderTimers(); }
        
        function renderTimers() {
            const list = document.getElementById('timerList');
            list.innerHTML = '';
            if(appData.timers.length === 0) { list.innerHTML = '<div class="text-center text-slate-500 text-sm py-8 font-mono font-bold">Keine aktiven Timer</div>'; return; }
            const sortedTimers = [...appData.timers].sort((a, b) => {
                if (a.isOverdue && !b.isOverdue) return -1;
                if (!a.isOverdue && b.isOverdue) return 1;
                return (a.durationMs - (Date.now() - a.startTime)) - (b.durationMs - (Date.now() - b.startTime));
            });
            sortedTimers.forEach(timer => {
                const el = document.createElement('div');
                const stateClasses = timer.isOverdue ? "bg-red-100/60 border-red-300 dark:bg-red-900/40 dark:border-red-500/60 animate-pulse-red-glow" : "bg-white/60 border-white/80 dark:bg-slate-800/60 dark:border-white/20 dark:animate-pulse-glow";
                el.className = `p-4 rounded-xl relative transition-all duration-300 overflow-hidden shadow-sm backdrop-blur-md border ${stateClasses}`;
                el.innerHTML = `
                    <div class="flex justify-between items-start mb-2 relative z-10">
                        <div><div class="font-bold text-sm text-slate-900 dark:text-white drop-shadow-sm">${timer.patient}</div><div class="text-xs font-bold text-helios-700 dark:text-helios-400 mt-0.5 uppercase tracking-wide">${timer.task}</div></div>
                        <button onclick="deleteTimer(${timer.id})" class="text-slate-500 hover:text-white transition w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-800/20"><i class="fa-solid fa-times"></i></button>
                    </div>
                    <div class="flex justify-between items-end mt-4 relative z-10">
                        <div class="text-xs font-mono font-bold px-2 py-1 rounded bg-white/60 border border-white/80 dark:bg-black/40 shadow-sm text-slate-700 dark:text-slate-200">Ziel: ${timer.durationMs / 60000}m</div>
                        <div class="font-mono font-bold text-3xl tracking-wider timer-display drop-shadow-sm ${timer.isOverdue ? 'text-red-700 dark:text-red-400 dark:text-glow-red' : 'text-helios-700 dark:text-helios-400 dark:text-glow-green'}" data-id="${timer.id}">--:--</div>
                    </div>
                    ${!timer.isOverdue ? `<div class="absolute bottom-0 left-0 h-1.5 bg-slate-200/50 dark:bg-helios-900/50 w-full"><div class="bg-helios-500 h-full progress-bar shadow-[0_0_10px_rgba(16,185,129,0.8)] transition-all duration-1000 ease-linear" data-id="${timer.id}" style="width: 0%;"></div></div>` : `<div class="absolute bottom-0 left-0 h-1.5 bg-red-500 w-full shadow-[0_0_15px_rgba(239,68,68,1)]"></div>`}
                `;
                list.appendChild(el);
            });
            updateTimerDisplays(Date.now());
        }

        function updateTimerDisplays(now) {
            appData.timers.forEach(timer => {
                const display = document.querySelector(`.timer-display[data-id="${timer.id}"]`), progress = document.querySelector(`.progress-bar[data-id="${timer.id}"]`);
                if(display) {
                    const diff = timer.durationMs - (now - timer.startTime);
                    display.innerText = diff <= 0 ? "+" + formatTimeDiff(Math.abs(diff)) : formatTimeDiff(diff);
                    if(progress && diff > 0) progress.style.width = `${((now - timer.startTime) / timer.durationMs) * 100}%`;
                }
            });
            appData.transports.forEach(t => {
                if (t.status === 'done') return;
                const display = document.querySelector(`.trans-timer-display[data-id="${t.id}"]`), progress = document.querySelector(`.trans-progress-bar[data-id="${t.id}"]`), transElement = document.querySelector(`.trans-item[data-id="${t.id}"]`);
                if(display) {
                    if (t.isAsap) {
                        display.innerText = "+" + formatTimeDiff(now - t.targetMs); display.classList.add('text-red-600', 'dark:text-red-400');
                        if(progress) progress.style.width = `${Math.min(((now - t.targetMs) / 1800000) * 100, 100)}%`;
                        if(transElement && t.status === 'waiting') { transElement.classList.add('animate-pulse-border-red'); transElement.classList.remove('animate-pulse-border-indigo'); }
                    } else {
                        const diff = t.targetMs - now;
                        if(diff <= 0) {
                            display.innerText = "+" + formatTimeDiff(Math.abs(diff)); display.classList.add('text-red-600', 'dark:text-red-400'); display.classList.remove('text-indigo-700');
                            if(progress) progress.style.width = '100%';
                            if(transElement && t.status === 'waiting') { transElement.classList.add('animate-pulse-border-red'); transElement.classList.remove('animate-pulse-border-indigo'); }
                        } else {
                            display.innerText = formatTimeDiff(diff); display.classList.remove('text-red-600', 'dark:text-red-400'); display.classList.add('text-indigo-700', 'dark:text-indigo-400');
                            if(progress) progress.style.width = `${Math.min(Math.max(((now - t.id) / (t.targetMs - t.id)) * 100, 0), 100)}%`;
                            if(transElement && t.status === 'waiting') { transElement.classList.add('animate-pulse-border-indigo'); transElement.classList.remove('animate-pulse-border-red'); }
                        }
                    }
                }
            });
        }

        // Feature: Transports
        function addTransport() {
            const patient = document.getElementById('transPatient').value, ziel = document.getElementById('transZiel').value, timeInput = document.getElementById('transTime').value;
            if(!patient || !ziel) { alert("Patient und Ziel müssen ausgefüllt sein."); return; }
            let targetMs = Date.now(), isAsap = true;
            if(timeInput) { const [hours, mins] = timeInput.split(':'); const d = new Date(); d.setHours(parseInt(hours), parseInt(mins), 0, 0); targetMs = d.getTime(); isAsap = false; }
            appData.transports.push({ id: Date.now(), patient: patient, ziel: ziel, timeString: timeInput || "ASAP", targetMs: targetMs, isAsap: isAsap, status: "waiting" });
            saveData(); renderTransports();
            document.getElementById('transPatient').value = ""; document.getElementById('transZiel').value = ""; document.getElementById('transTime').value = "";
        }
        function updateTransportStatus(id, newStatus) { const t = appData.transports.find(x => x.id === id); if(t) { t.status = newStatus; saveData(); renderTransports(); } }
        function deleteTransport(id) { appData.transports = appData.transports.filter(t => t.id !== id); saveData(); renderTransports(); }
        function renderTransports() {
            const list = document.getElementById('transportList');
            list.innerHTML = '';
            if(appData.transports.length === 0) { list.innerHTML = '<div class="text-center text-slate-500 text-sm py-8 font-mono font-bold">Keine Transporte disponiert</div>'; return; }
            appData.transports.forEach(t => {
                let statusColor = "bg-white/60 border-white/80 dark:bg-slate-800/60 dark:border-white/20", badgeColor = "bg-white/80 border-slate-300 dark:bg-black/40", pulseClass = "";
                if(t.status === 'progress') { statusColor = "bg-amber-100/60 border-amber-300 text-amber-900 dark:bg-amber-900/40"; badgeColor = "bg-amber-200/80 border-amber-400 text-amber-800"; pulseClass = "animate-pulse-border-amber"; } 
                else if(t.status === 'done') { statusColor = "bg-helios-100/50 border-helios-300 text-helios-900 opacity-70"; badgeColor = "bg-helios-200/80 border-helios-400"; } 
                else { pulseClass = (t.isAsap || t.targetMs <= Date.now()) ? "animate-pulse-border-red" : "animate-pulse-border-indigo"; }
                const el = document.createElement('div'); el.className = `trans-item p-3 rounded-xl border flex flex-col gap-2 transition-all shadow-sm backdrop-blur-md relative overflow-hidden ${statusColor} ${pulseClass}`; el.dataset.id = t.id;
                const timerHtml = t.status !== 'done' ? `<div class="font-mono text-sm font-bold trans-timer-display" data-id="${t.id}">--:--</div>` : `<div class="font-mono text-sm font-bold opacity-70">Erledigt</div>`;
                let pBar = '';
                if(t.status !== 'done') pBar = `<div class="absolute bottom-0 left-0 h-1.5 bg-slate-200/50 w-full rounded-b-xl overflow-hidden"><div class="${t.isAsap ? 'bg-red-500' : 'bg-indigo-500'} h-full trans-progress-bar transition-all duration-1000 ease-linear" data-id="${t.id}" style="width: 0%;"></div></div>`;
                el.innerHTML = `
                    <div class="flex justify-between items-start relative z-10"><div class="font-bold text-sm">${t.patient}</div><div class="flex items-center gap-2">${timerHtml}<div class="font-mono text-xs font-bold px-2 py-0.5 rounded border shadow-sm ${badgeColor}">${t.timeString}</div></div></div>
                    <div class="text-sm font-bold opacity-90 mt-1 relative z-10"><i class="fa-solid fa-location-dot mr-1.5"></i> ${t.ziel}</div>
                    <div class="flex justify-between items-center mt-2 pt-3 border-t border-black/10 relative z-10">
                        <div class="flex gap-1">
                            ${t.status !== 'progress' ? `<button onclick="updateTransportStatus(${t.id}, 'progress')" class="w-8 h-8 rounded-lg bg-amber-200/60 hover:bg-amber-300 text-amber-700"><i class="fa-solid fa-truck-fast"></i></button>` : ''}
                            ${t.status !== 'done' ? `<button onclick="updateTransportStatus(${t.id}, 'done')" class="w-8 h-8 rounded-lg bg-helios-200/60 hover:bg-helios-300 text-helios-700"><i class="fa-solid fa-check"></i></button>` : ''}
                        </div>
                        <button onclick="deleteTransport(${t.id})" class="w-8 h-8 flex justify-center items-center rounded-lg text-slate-500 hover:text-red-600 hover:bg-white/50"><i class="fa-solid fa-trash"></i></button>
                    </div>${pBar}`;
                list.appendChild(el);
            });
            updateTimerDisplays(Date.now());
        }

        // Feature: Vitals
        function addAllergy(val) { const i = document.getElementById('vitAllergies'); let c = i.value.trim(); if (c === 'Keine bekannt' || c === '') i.value = val; else if (!c.includes(val)) i.value = c + ', ' + val; }
        function setAllergy(val) { document.getElementById('vitAllergies').value = val; }
        function clearVitals() { ['vitPatient','vitAllergies','vitRR','vitHF','vitAF','vitSpO2','vitTemp','vitMisc'].forEach(id => document.getElementById(id).value = ''); }
        function copyVitals() {
            let t = "VITALWERTE:\n";
            const f = (id, lbl) => { const v = document.getElementById(id).value; if(v) t += `${lbl}: ${v}\n`; };
            f('vitPatient','Patient'); f('vitAllergies','ALLERGIEN'); f('vitRR','RR'); f('vitHF','HF'); f('vitAF','AF'); f('vitSpO2','SpO2'); f('vitTemp','Temp'); f('vitMisc','Zusatz');
            t += `Zeit: ${new Date().toLocaleTimeString('de-DE').substring(0,5)} Uhr`;
            navigator.clipboard.writeText(t).then(() => { const toast = document.getElementById('copyToast'); toast.classList.remove('hidden'); setTimeout(() => toast.classList.add('hidden'), 2500); }).catch(err => {
                const ta = document.createElement("textarea"); ta.value = t; document.body.appendChild(ta); ta.select(); try { document.execCommand('copy'); const toast = document.getElementById('copyToast'); toast.classList.remove('hidden'); setTimeout(() => toast.classList.add('hidden'), 2500); } catch (e) {} document.body.removeChild(ta);
            });
        }

        // Feature: Notes & Checkliste
        function saveNotes() { appData.notes = document.getElementById('notesArea').value; saveData(); }
        let draggedTaskId = null;
        function addTask() { const i = document.getElementById('newTaskInput'), text = i.value.trim(); if(!text) return; appData.tasks.unshift({id: Date.now(), text: text, done: false}); i.value = ''; saveData(); renderTasks(); }
        function toggleTask(id) { const i = appData.tasks.findIndex(t => t.id === id); if(i !== -1) { appData.tasks[i].done = !appData.tasks[i].done; const t = appData.tasks.splice(i, 1)[0]; if (t.done) appData.tasks.push(t); else appData.tasks.unshift(t); saveData(); renderTasks(); } }
        function deleteTask(id) { appData.tasks = appData.tasks.filter(t => t.id !== id); saveData(); renderTasks(); }
        
        function handleTaskDragStart(e) { draggedTaskId = Number(this.dataset.id); e.dataTransfer.effectAllowed = 'move'; setTimeout(() => this.classList.add('task-dragging'), 0); }
        function handleTaskDrop(e) {
            e.stopPropagation(); this.classList.remove('task-drag-over'); const dropTargetId = Number(this.dataset.id);
            if (draggedTaskId && draggedTaskId !== dropTargetId) {
                const dIdx = appData.tasks.findIndex(t => t.id === draggedTaskId), tIdx = appData.tasks.findIndex(t => t.id === dropTargetId);
                if (dIdx !== -1 && tIdx !== -1) { const [r] = appData.tasks.splice(dIdx, 1); appData.tasks.splice(tIdx, 0, r); saveData(); renderTasks(); }
            }
            return false;
        }
        function handleTaskDragEnd() { this.classList.remove('task-dragging'); document.querySelectorAll('.task-item').forEach(el => el.classList.remove('task-drag-over')); draggedTaskId = null; }

        function renderTasks() {
            const list = document.getElementById('taskList'); list.innerHTML = '';
            if(appData.tasks.length === 0) { list.innerHTML = '<div class="text-center text-slate-500 py-4 font-mono font-bold">Keine Aufgaben</div>'; return; }
            appData.tasks.forEach(task => {
                const el = document.createElement('div');
                const textStyle = task.done ? "line-through text-slate-500" : "font-medium";
                const bgStyle = task.done ? "bg-white/30 dark:bg-white/5 opacity-60" : "bg-white/70 dark:bg-slate-800/60 cursor-grab active:cursor-grabbing backdrop-blur-md shadow-sm";
                el.className = `task-item flex items-center gap-3 p-3 rounded-lg border ${bgStyle}`; el.dataset.id = task.id;
                if (!task.done) { el.draggable = true; el.addEventListener('dragstart', handleTaskDragStart); el.addEventListener('dragover', e => {e.preventDefault(); return false;}); el.addEventListener('dragenter', function() { if(Number(this.dataset.id) !== draggedTaskId) this.classList.add('task-drag-over');}); el.addEventListener('dragleave', function() {this.classList.remove('task-drag-over')}); el.addEventListener('drop', handleTaskDrop); el.addEventListener('dragend', handleTaskDragEnd); }
                el.innerHTML = `${!task.done ? `<div class="text-slate-400 cursor-grab"><i class="fa-solid fa-grip-vertical"></i></div>` : `<div class="w-2"></div>`}<button onclick="toggleTask(${task.id})" class="text-xl hover:scale-110">${task.done ? "<i class='fa-solid fa-circle-check text-helios-600'></i>" : "<i class='fa-regular fa-circle text-slate-400'></i>"}</button><span class="flex-1 text-sm ${textStyle}">${task.text}</span><button onclick="deleteTask(${task.id})" class="text-slate-400 hover:text-red-600 p-1"><i class="fa-solid fa-trash"></i></button>`;
                list.appendChild(el);
            });
        }
    </script>
</body>
</html>
